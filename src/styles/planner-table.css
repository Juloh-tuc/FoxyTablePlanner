/* ===========================
   planner-table.css — FoxyTable v2
   - Actions compactes (même taille)
   - Pas de débordement à droite (wrap autorisé)
   - Thème bleu minuit #191970 + accent #E5813E
   =========================== */

/* ----------- Variables ----------- */
:root {
  --ft-bg: #ffffff;
  --ft-surface: #ffffff;
  --ft-surface-2: #fbfbfd;
  --ft-brd: #e5e7eb;
  --ft-muted: #6b7280;
  --ft-text: #0f172a;

  /* Thème Foxy */
  --ft-brand-main: #191970;
  --ft-brand-main-rgb: 25,25,112;
  --ft-accent: #E5813E;
  --ft-accent-rgb: 229,129,62;

  --ft-brand: var(--ft-brand-main);
  --ft-ring: rgba(var(--ft-brand-main-rgb), .28);

  --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.06);

  /* Tailles des boutons d'actions */
  --ft-action-btn-h: 36px;
  --ft-action-btn-minw: 96px;

  /* Table */
  --tbl-outline: rgba(0, 0, 0, 0.06);
  --tbl-row-sep: rgba(0, 0, 0, 0.06);
  --tbl-header-bg: #fafafa;
  --tbl-shadow-sm: 0 0.0625rem 0.125rem rgba(0, 0, 0, 0.05);
}

/* ----------- Wrapper / Layout ----------- */
.table-wrap {
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  scrollbar-gutter: stable both-edges;
  max-height: clamp(60vh, 72vh, 78vh);
}
.card { background:#fff; border-radius:12px; box-shadow:var(--shadow-sm); }

/* Full-bleed */
.ft-fullbleed{
  width:100vw;
  margin-left:calc(50% - 50vw);
  margin-right:calc(50% - 50vw);
  padding-left:max(16px, calc((100vw - 1700px)/2));
  padding-right:max(16px, calc((100vw - 1700px)/2));
}
.ft-wrap{ color:var(--ft-text); }

/* ----------- Toolbar & contrôles ----------- */
.ft-toolbar{
  display:flex; justify-content:space-between; align-items:center;
  gap:12px; margin-bottom:12px; flex-wrap:wrap;
}
.ft-left{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
.ft-right{ display:flex; gap:10px; align-items:center; }
.ft-count{ color:var(--ft-muted); font-size:.92rem; }

.ft-input-wrap{ position:relative; }
.ft-input-ico{
  position:absolute; left:10px; top:50%; transform:translateY(-50%);
  opacity:.6; pointer-events:none;
}
.ft-input{
  padding:10px 12px 10px 32px; border:1px solid var(--ft-brd); border-radius:10px;
  background:#fff; min-width:260px; outline:none; color:var(--ft-text);
  transition: box-shadow .12s ease, border-color .12s ease, background .12s ease;
}
.ft-input:focus{ box-shadow:0 0 0 3px var(--ft-ring); border-color:rgba(var(--ft-brand-main-rgb), .45); }
.ft-input::placeholder{ color:#9aa1ad; }

.ft-select{
  padding:10px 12px; border:1px solid var(--ft-brd); border-radius:10px; background:#fff; outline:none;
  transition: box-shadow .12s ease, border-color .12s ease, background .12s ease;
}
.ft-select:focus{ box-shadow:0 0 0 3px var(--ft-ring); border-color:rgba(var(--ft-brand-main-rgb), .45); }

/* ----------- Boutons génériques ----------- */
.ft-btn{
  padding:8px 12px; border-radius:10px; border:1px solid var(--ft-brd); background:#fff; cursor:pointer;
  transition: background .15s ease, border-color .15s ease, transform .04s ease, box-shadow .15s ease;
  color:var(--ft-text);
}
.ft-btn:hover{ background:#f9fafb; }
.ft-btn:focus-visible{ outline:0; box-shadow:0 0 0 3px var(--ft-ring); }
.ft-btn.ghost{ background:transparent; }

.ft-btn.primary{
  background:var(--ft-brand); color:#fff; border-color:var(--ft-brand);
  box-shadow:0 6px 16px rgba(var(--ft-brand-main-rgb), .15);
}
.ft-btn.primary:hover{ filter:brightness(1.06); transform:translateY(-1px); }

.ft-btn.danger{
  background:#fff; border-color:var(--ft-accent); color:var(--ft-accent);
}
.ft-btn.danger:hover{ background:rgba(var(--ft-accent-rgb), .08); }

/* Bouton “Ajouter” (supporte .ft-add-btn et .add-btn) */
.ft-add-btn .ico-plus,
.ft-btn.add-btn .ico-plus{ color:var(--ft-accent); font-weight:800; transform:translateY(-1px); }

/* Bouton meeting */
.meeting-toggle{
  display:inline-flex; align-items:center; gap:10px; padding:10px 14px;
  border-radius:999px; border:1px solid #d1d5db; background:#fff; cursor:pointer; font-weight:800;
}
.meeting-toggle .mt-dot{ width:10px; height:10px; border-radius:999px; background:#9ca3af; box-shadow:0 0 0 3px #e5e7eb inset; }

/* ----------- Table ----------- */
.table{
  width:100%; table-layout:auto; border-collapse:separate; border-spacing:0; background:#fff;
  border-radius:.75rem; overflow:hidden; position:relative; min-width:860px;
  box-shadow:var(--tbl-shadow-sm);
}
.table thead th{
  position:sticky; top:0; z-index:3; background:var(--tbl-header-bg);
  font-weight:800; padding:.75rem .875rem; height:3.25rem;
  box-shadow: inset 0 -1px var(--tbl-row-sep); text-align:left; white-space:nowrap;
}
.table th,.table td{
  padding:.75rem .875rem; font-size:clamp(.9rem,1.1vw,.95rem); line-height:1.45; vertical-align:middle; border:none; color:var(--ft-text);
}
.table tbody tr:nth-child(odd) td{ background:#ffffff; }
.table tbody tr:nth-child(even) td{ background:var(--ft-surface-2); }
.table tbody tr td{ box-shadow: inset 0 -1px var(--tbl-row-sep); }
.table tbody tr:last-child td{ box-shadow:none; }

/* Bordure intérieure */
.table::before{
  content:""; position:absolute; inset:0; pointer-events:none; border-radius:.75rem; box-shadow: inset 0 0 0 1px var(--tbl-outline);
}

/* Colonne collante (si utilisée) */
.col-sticky{ position:sticky; left:0; z-index:2; background:#fff; box-shadow:1px 0 0 var(--ft-brd); }
.table thead .col-sticky{ z-index:4; background:var(--tbl-header-bg); }

/* Largeurs */
.col-titre{ min-width:40rem; }
.col-remarques{ min-width:36rem; }
.col-debut,.col-echeance{ min-width:8.5rem; }
.col-admin{ min-width:11rem; position:relative; }
.col-statut{ min-width:9rem; }
.col-priorite{ min-width:8.5rem; }
.col-bloque,.col-bloque-par{ min-width:16rem; }
.col-etq{ min-width:14rem; }
.col-actions{
  /* important : permettre le retour à la ligne pour éviter les coupures */
  white-space: normal;
  min-width: 13.5rem;
}
.wrap{ white-space:normal; word-break:break-word; hyphens:auto; }

/* ----------- Cellule Titre ----------- */
.title-cell{ display:flex; align-items:center; gap:8px; min-height:2.25rem; }
.title-link{
  display:inline-flex; align-items:center; gap:10px; max-width:100%; padding:6px 10px;
  border:1px solid transparent; background:transparent; border-radius:12px; cursor:pointer;
  font-weight:800; color:#0f172a; transition: background .15s, border-color .15s, transform .04s;
}
.title-link .title-text{ max-width:60ch; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.title-link .chev{ opacity:0; transform:translateX(-4px); transition: transform .15s, opacity .15s; font-size:1.1rem; line-height:1; color:var(--ft-brand); }
.title-link:hover{ background:#f6f7ff; border-color:#e4e7ff; }
.title-link:hover .chev{ opacity:1; transform:translateX(0); }
.title-link:active{ transform:translateY(1px); }
.title-link:focus-visible{ outline:none; box-shadow:0 0 0 3px var(--ft-ring); border-color:rgba(var(--ft-brand-main-rgb), .45); }
.rename-btn{ border-color:#e7e7fb; }
.rename-btn:hover{ background:#f6f7ff; }

/* ----------- Priorité ----------- */
.prio-pill{
  display:inline-block; padding:.35rem .75rem; border-radius:999px; font-size:.85rem; font-weight:800; color:#fff;
  line-height:1; white-space:nowrap; min-width:5.75rem; text-align:center;
  box-shadow:0 0.0625rem 0.125rem rgba(0,0,0,.08);
}
.prio-low{ background:linear-gradient(135deg,#3b82f6,#60a5fa); }
.prio-medium{ background:linear-gradient(135deg,#f59e0b,#f97316); }
.prio-high{ background:linear-gradient(135deg,#ef4444,#f97393); }

/* ----------- Badges statut ----------- */
.badge{
  display:inline-flex; align-items:center; gap:6px; padding:4px 8px; border-radius:999px; border:1px solid #e5e7eb;
  font-size:.8rem; font-weight:700;
}
.badge-termine{      background:#ecfdf5; border-color:#34d399; color:#065f46; }
.badge-en-cours{     background:#fefce8; border-color:#facc15; color:#854d0e; }
.badge-en-attente{   background:#eff6ff; border-color:#93c5fd; color:#1e40af; }
.badge-bloque{       background:#fef2f2; border-color:#fca5a5; color:#991b1b; }
.badge-pas-commence{ background:#f3f4f6; border-color:#d1d5db; color:#374151; }

/* ----------- Étiquettes ----------- */
.tags{ display:flex; flex-wrap:wrap; gap:6px; }
.tag{
  display:inline-flex; align-items:center; gap:.375rem; padding:.25rem .625rem; border-radius:999px;
  font-size:.85rem; font-weight:700; background:#eef2ff; border:1px solid #e5e7eb; color:#1e293b;
}
.etq-cell{ position:relative; }
.tag-add{
  margin-left:8px; width:28px; height:28px; border-radius:8px; border:1px solid #e5e7eb; background:#fff; cursor:pointer;
}
.tag-add:hover{ background:#f9fafb; }

/* ----------- Actions (cellule) ----------- */
.ft-actions{ display:flex; gap:6px; align-items:center; flex-wrap:wrap; }
.ft-actions .ft-btn,
.ft-actions .ft-btn.primary,
.ft-actions .ft-btn.ghost,
.ft-actions .ft-btn.danger,
.ft-actions .ft-btn.danger.ghost{
  height: var(--ft-action-btn-h);
  min-width: var(--ft-action-btn-minw);
  padding: 0 10px;
  font-size: .9rem;
  border-radius: 10px;
}

/* ----------- Modales ----------- */
.ft-modal-overlay{
  position:fixed; inset:0; background:rgba(17,24,39,.45);
  display:flex; align-items:center; justify-content:center; z-index:50;
}
.ft-modal{
  width:100%; max-width:520px; background:#fff; border-radius:14px; padding:18px; box-shadow:0 6px 20px rgba(0,0,0,.08);
}
.ft-modal.ft-lg{ max-width:820px; }
.ft-modal-header{ display:flex; align-items:center; justify-content:space-between; }
.ft-modal-title{ margin:0 0 6px; font-size:1.1rem; }
.ft-modal-text{ color:#6b7280; margin-bottom:14px; }
.ft-modal-actions{ display:flex; gap:8px; align-items:center; }
.ft-modal-actions.end{ justify-content:flex-end; }
.ft-icon-btn{ border:none; background:#fff; width:32px; height:32px; border-radius:8px; cursor:pointer; }
.ft-icon-btn:hover{ background:#f3f4f6; }
.ft-empty{ text-align:center; padding:24px; color:#6b7280; }

/* Archivées */
.ft-arch-toolbar{ display:flex; gap:10px; align-items:center; margin:6px 0 10px; flex-wrap:wrap; }
.ft-arch-list{ display:flex; flex-direction:column; gap:10px; max-height:56vh; overflow:auto; padding-right:2px; }
.ft-arch-item{
  display:flex; align-items:center; justify-content:space-between; gap:12px;
  border:1px solid #e5e7eb; border-radius:12px; padding:10px 12px; background:#fff;
}
.ft-arch-title{ font-weight:600; }
.ft-arch-meta{ display:flex; gap:8px; align-items:center; color:#6b7280; font-size:.9rem; }

/* ----------- Lecture seule ----------- */
.is-readonly button[disabled],
.is-readonly .ft-btn[disabled],
.meeting-on [disabled],
.meeting-on .ft-btn[disabled]{ opacity:.5; cursor:not-allowed; filter:grayscale(.15); }

/* ----------- Mode réunion (bleu) ----------- */
.meeting-on .ft-toolbar{
  background: linear-gradient(90deg, rgba(var(--ft-brand-main-rgb), .08), rgba(var(--ft-brand-main-rgb), .04));
  color:#111827; border:1px solid rgba(var(--ft-brand-main-rgb), .25); border-radius:12px; padding:10px;
}
.meeting-on .ft-toolbar .ft-btn{ border-color:rgba(var(--ft-brand-main-rgb), .25); background:#fff; color:#111827; }
.meeting-on .ft-toolbar .ft-btn:hover{ background:rgba(var(--ft-brand-main-rgb), .06); }
.meeting-on .ft-toolbar .ft-btn.primary{ background:var(--ft-brand); border-color:var(--ft-brand); color:#fff; }
.meeting-on .ft-input,.meeting-on .ft-select{ background:#fff; border-color:rgba(var(--ft-brand-main-rgb), .25); }
.meeting-on .ft-input:focus,.meeting-on .ft-select:focus{ box-shadow:0 0 0 3px var(--ft-ring); border-color:rgba(var(--ft-brand-main-rgb), .45); }
.meeting-on .ft-count{ color:#4b5563; }
.meeting-on .meeting-toggle{ background:rgba(var(--ft-brand-main-rgb), .06); border-color:rgba(var(--ft-brand-main-rgb), .25); color:#111827; }
.meeting-on .meeting-toggle .mt-dot{ background:#22c55e; box-shadow:0 0 0 3px rgba(var(--ft-brand-main-rgb), .18) inset; }

/* Badge fixe */
.meeting-badge{
  position:fixed; top:10px; right:10px; z-index:60;
  font-weight:800; font-size:.9rem; background:rgba(var(--ft-brand-main-rgb), .10);
  border:1px solid rgba(var(--ft-brand-main-rgb), .35); color:var(--ft-brand);
  padding:6px 10px; border-radius:999px;
}

/* Table claire */
.meeting-on .table thead th{ background:rgba(var(--ft-brand-main-rgb), .10); color:#111827; box-shadow: inset 0 -1px rgba(var(--ft-brand-main-rgb), .25); }
.meeting-on .table{ font-size:1.05rem; }
.meeting-on .table tbody td{ padding-top:1rem; padding-bottom:1rem; background:#ffffff; }
.meeting-on .table tbody tr:nth-child(even) td{ background:rgba(var(--ft-brand-main-rgb), .03); }

.meeting-on .title-link{ color:#1f2937; }
.meeting-on .title-link:hover{ background:rgba(var(--ft-brand-main-rgb), .06); border-color:rgba(var(--ft-brand-main-rgb), .18); }
.meeting-on .title-link .chev{ color:var(--ft-brand); }

/* ----------- Inputs inline ----------- */
.cell-input{
  width:100%; max-width:100%; padding:.5rem .625rem; border-radius:.625rem;
  background:#fff; font:inherit; border:1px solid var(--ft-brd); color:var(--ft-text);
}
.cell-input:focus{ outline:none; box-shadow:0 0 0 3px var(--ft-ring); border-color:rgba(var(--ft-brand-main-rgb), .45); }
.cell-input.title-input{ min-width:24rem; }

/* ----------- Filtre multi-admins ----------- */
.admin-filter{ position:relative; }
.af-popover{
  position:absolute; top:calc(100% + 6px); left:0; width:min(320px, 86vw);
  background:#fff; border:1px solid var(--ft-brd); border-radius:12px;
  box-shadow:0 12px 28px rgba(0,0,0,.12); padding:10px; z-index:20;
}
.af-head{ display:flex; align-items:center; gap:8px; margin-bottom:6px; }
.af-head .spacer{ flex:1; }
.af-list{ display:flex; flex-direction:column; gap:6px; max-height:260px; overflow:auto; padding-right:2px; }
.af-row{
  display:flex; align-items:center; gap:10px; padding:6px 8px; border:1px solid #e5e7eb; border-radius:8px;
}
.af-row:hover{ background:#f9fafb; }
.af-actions{ margin-top:8px; display:flex; justify-content:flex-end; gap:8px; }

/* ----------- Popovers Personnes/Bloque ----------- */
.pp-popover{
  z-index:1000; width:min(380px,92vw); background:#fff; border:1px solid var(--ft-brd);
  border-radius:12px; box-shadow:0 12px 28px rgba(0,0,0,.12); padding:10px;
  box-sizing:border-box; max-width:min(420px,92vw); max-height:70vh; display:flex; flex-direction:column;
}
.pp-popover.slim{ max-width:min(360px,92vw); }
.pp-head{ display:flex; align-items:center; gap:8px; margin-bottom:8px; flex-wrap:wrap; }
.pp-head .spacer{ flex:1; }
.pp-search{
  flex:1 1 160px; min-width:0; padding:.45rem .6rem; border-radius:10px; border:1px solid var(--ft-brd); background:#fff; color:var(--ft-text);
}
.pp-search:focus{ outline:none; box-shadow:0 0 0 3px var(--ft-ring); border-color:rgba(var(--ft-brand-main-rgb), .45); }
.pp-list{ display:flex; flex-direction:column; gap:8px; flex:1 1 auto; overflow:auto; padding-right:2px; max-height:240px; }
.pp-row{
  display:grid; grid-template-columns:auto 28px 1fr auto; align-items:center;
  gap:10px; padding:6px 8px; border:1px solid #e5e7eb; border-radius:8px;
}
.pp-row:hover{ background:#f9fafb; }
.sticky-actions{
  position:sticky; bottom:0; background:#fff;
  padding-top:8px; display:flex; gap:8px; justify-content:flex-end;
}

/* ----------- AdminPicker (portal) ----------- */
.ft-admin-btn{
  display:inline-flex; align-items:center; gap:.5rem;
  padding:.375rem .625rem; border:1px solid var(--ft-brd);
  background:var(--ft-surface); border-radius:.5rem; font-size:.875rem; line-height:1.1; cursor:pointer;
}
.ft-admin-btn:hover{ box-shadow:var(--shadow-sm); }
.ft-admin-name{ max-width:12rem; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

.ft-admin-panel{
  background:var(--ft-surface); color:var(--ft-text); border:1px solid var(--ft-brd); border-radius:.75rem;
  box-shadow:0 10px 24px rgba(0,0,0,.08); width:280px; display:flex; flex-direction:column; z-index:1100;
}
.ft-admin-panel__header{ padding:.5rem .75rem; font-weight:600; border-bottom:1px solid var(--ft-brd); }
.ft-admin-panel__search{ padding:.5rem .75rem; border-bottom:1px solid var(--ft-brd); }
.ft-admin-input{ width:100%; padding:.5rem .625rem; border:1px solid var(--ft-brd); border-radius:.5rem; font-size:.875rem; }
.ft-admin-panel__list{ padding:.25rem; display:flex; flex-direction:column; max-height:260px; overflow:auto; }
.ft-admin-row{
  display:flex; align-items:center; gap:.5rem; padding:.5rem .5rem; border-radius:.5rem; cursor:pointer; border:0; background:transparent; text-align:left;
}
.ft-admin-row:hover{ background:var(--ft-surface-2); }
.ft-admin-row.is-active{ background:rgba(var(--ft-brand-main-rgb), .08); }
.ft-admin-row__check{ width:1rem; text-align:center; font-weight:700; }
.ft-admin-row__name{ flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.ft-admin-panel__footer{ display:flex; gap:.5rem; justify-content:flex-end; padding:.5rem .75rem; border-top:1px solid var(--ft-brd); }
.ft-admin-primary,.ft-admin-secondary{
  padding:.5rem .75rem; border-radius:.5rem; font-size:.875rem; border:1px solid var(--ft-brd);
  background:var(--ft-surface); cursor:pointer;
}
.ft-admin-primary{ background:var(--ft-brand); color:#fff; border-color:transparent; }
.ft-admin-primary:hover{ filter:brightness(.98); }

/* ----------- Scrollbars ORANGE ----------- */
:where(.table-wrap, .ft-arch-list, .pp-list, .af-list){
  scrollbar-color: var(--ft-accent) #fff7ef; /* Firefox */
  scrollbar-width: thin;
}
:where(.table-wrap, .ft-arch-list, .pp-list, .af-list)::-webkit-scrollbar{ height:10px; width:10px; }
:where(.table-wrap, .ft-arch-list, .pp-list, .af-list)::-webkit-scrollbar-thumb{
  background:var(--ft-accent); border-radius:999px; border:2px solid #fff;
}
:where(.table-wrap, .ft-arch-list, .pp-list, .af-list)::-webkit-scrollbar-track{
  background:#fff7ef; border-radius:999px;
}

/* ----------- Responsive ----------- */
@media (max-width:1280px){
  .col-titre{ min-width:28rem; }
  .col-remarques{ min-width:26rem; }
}
@media (max-width:900px){
  .ft-input{ min-width:200px; }
  .table thead th{ height:3rem; }
  .col-titre{ min-width:22rem; }
  .col-remarques{ min-width:20rem; }
}

/* ----------- Accessibilité ----------- */
@media (prefers-reduced-motion: reduce){
  *{ animation:none !important; transition:none !important; }
}
