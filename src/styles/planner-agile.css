/* ================================
   planner-agile.css — Kanban Agile
   ================================ */

:root{
  --wrap-max: 87.5rem;
  --gutter: 1rem;

  --border: #e5e7eb;
  --text: #111827;
  --muted: #6b7280;
  --surface: #ffffff;
  --surface-2: #fafafa;
  --shadow-sm: 0 1px 2px rgba(0,0,0,.06);
  --shadow:    0 10px 24px rgba(0,0,0,.08);

  --done-bg:    #ecfdf5; --done-brd: #34d399; --done-txt: #065f46;
  --prog-bg:    #fefce8; --prog-brd: #facc15; --prog-txt: #713f12;
  --block-bg:   #fef2f2; --block-brd:#fca5a5; --block-txt:#7f1d1d;
  --todo-bg:    #eff6ff; --todo-brd: #93c5fd; --todo-txt: #1e3a8a;

  --brand: #7c3aed;
  --ring: #a78bfa33;

  /* Hauteur de base pour dimensionner les colonnes (3–4 cartes au repos) */
  --kan-gap: 0.625rem;      /* même gap que la liste */
  --kan-card-min: 5.25rem;  /* hauteur visuelle mini d’une carte */
}

/* ===== Toolbar (on réutilise .ft-toolbar de la table) ===== */
.agile.meeting-on .ft-toolbar{
  background: linear-gradient(90deg, #ede9fe, #eef2ff);
  border: 1px solid #ddd6fe;
  color: #1f2937;
  border-radius: 12px;
  padding: 10px;
}

/* ===== Layout ===== */
.agile{ display:block; }
.ft-fullbleed{
  width: 100vw;
  margin-left: calc(50% - 50vw);
  margin-right: calc(50% - 50vw);
  padding-left: max(16px, calc((100vw - 1700px) / 2));
  padding-right: max(16px, calc((100vw - 1700px) / 2));
}

/* ===== Board ===== */
.kan-board{
  display:grid; grid-template-columns: 1fr; gap:0.75rem; margin-top:10px;
}
@media (min-width:980px){
  .kan-board{ grid-template-columns: repeat(4, 1fr); gap:0.875rem; }
}
@media (min-width:1280px){
  .kan-board{ grid-template-columns: repeat(4, minmax(20rem, 1fr)); gap:1.125rem; }
}

.kan-col{
  border:1px solid var(--border);
  background:var(--surface);
  border-radius:1rem;
  overflow: visible;
  box-shadow: var(--shadow-sm);
}

.kan-col__title{
  font-weight:800; padding:0.625rem 0.75rem; background:var(--surface-2);
  border-bottom:1px solid var(--border);
  display:flex; align-items:center; justify-content:space-between;
}
.kan-col__title .count{
  font-weight:800; padding:0.125rem 0.5rem; border-radius:999px;
  border:1px solid var(--border); background:#fff; font-variant-numeric: tabular-nums;
}

/* En-têtes colorés par statut */
.kan-col__title.is-done{
  background: linear-gradient(90deg, rgba(52,211,153,.18), transparent 40%);
  box-shadow: inset 4px 0 0 0 var(--done-brd);
}
.kan-col__title.is-progress{
  background: linear-gradient(90deg, rgba(250,204,21,.18), transparent 40%);
  box-shadow: inset 4px 0 0 0 var(--prog-brd);
}
.kan-col__title.is-blocked{
  background: linear-gradient(90deg, rgba(252,165,165,.22), transparent 40%);
  box-shadow: inset 4px 0 0 0 var(--block-brd);
}
.kan-col__title.is-todo{
  background: linear-gradient(90deg, rgba(147,197,253,.20), transparent 40%);
  box-shadow: inset 4px 0 0 0 var(--todo-brd);
}

/* Liste des cartes — hauteur mini pensée pour 3–4 cartes, et s’agrandit ensuite */
.kan-col__list{
  padding:0.625rem;
  display:flex; flex-direction:column; gap:var(--kan-gap);
  /* 4 cartes * min-height + 3 gaps + un petit rab */
  min-height: calc(4 * var(--kan-card-min) + 3 * var(--kan-gap) + 0.5rem);
  overflow: visible;
}
@media (min-width:980px){
  :root{ --kan-card-min: 5.75rem; }
  .kan-col__list{
    min-height: calc(4 * var(--kan-card-min) + 3 * var(--kan-gap) + 0.75rem);
  }
}
@media (min-width:1280px){
  :root{ --kan-card-min: 6.25rem; }
  .kan-col__list{
    min-height: calc(4 * var(--kan-card-min) + 3 * var(--kan-gap) + 1rem);
  }
}

/* ===== Cartes ===== */
.kan-card{
  border:1px solid var(--border);
  background:#fff;
  border-radius:0.75rem;
  padding:0.75rem;
  box-shadow: var(--shadow-sm);
  transition: box-shadow .12s ease, transform .12s ease;
  min-height: var(--kan-card-min); /* socle visuel sans figer la hauteur */
}
.kan-card:hover{ transform: translateY(-1px); box-shadow: var(--shadow); }
.kan-card.is-archived{ opacity:.6; filter: grayscale(.12); }
.kan-card__top{ display:flex; align-items:center; gap:0.5rem; justify-content:space-between; }
.kan-card__titlewrap{ display:flex; align-items:center; gap:.5rem; min-width:0; }
.kan-card__title{
  font-weight:800; color:var(--text);
  display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
}
.kan-card__actions{ display:flex; gap:0.375rem; }

.admin-avatar{
  width:28px; height:28px; border-radius:999px; overflow:hidden;
  border:1px solid var(--border); display:inline-grid; place-items:center; background:#fff;
}
.admin-avatar img{ width:100%; height:100%; object-fit:cover; display:block; }
.admin-avatar .fallback{ font-size:.8rem; font-weight:800; color:#334155; }

.kan-card__meta{ display:flex; gap:0.5rem; align-items:center; flex-wrap:wrap; margin-top:0.25rem; }
.badge-prio{
  display:inline-flex; align-items:center; gap:0.375rem; padding:0.25rem 0.625rem;
  border-radius:999px; font-size:.85rem; font-weight:700;
  border:1px solid var(--border); background:#fff; color:#374151;
}
.badge-prio .dot{ width:8px; height:8px; border-radius:999px; display:inline-block; margin-right:2px; }
.badge-prio[data-level="Élevé"] .dot{ background:#ef4444; }
.badge-prio[data-level="Moyen"] .dot{ background:#f59e0b; }
.badge-prio[data-level="Faible"] .dot{ background:#10b981; }

.status-chip{
  display:inline-flex; align-items:center; gap:0.375rem; padding:0.25rem 0.625rem;
  border-radius:999px; font-size:.85rem; font-weight:700; border:1px solid var(--border);
}
.status-chip .dot{ width:8px; height:8px; border-radius:999px; display:inline-block; }
.status-chip.is-done{     background: var(--done-bg);  border-color: var(--done-brd);  color: var(--done-txt); }
.status-chip.is-progress{ background: var(--prog-bg);  border-color: var(--prog-brd);  color: var(--prog-txt); }
.status-chip.is-blocked{  background: var(--block-bg); border-color: var(--block-brd); color: var(--block-txt); }
.status-chip.is-todo{     background: var(--todo-bg);  border-color: var(--todo-brd);  color: var(--todo-txt); }

.prog-chip{
  display:inline-block; padding:0.125rem 0.5rem;
  border:1px solid var(--border); border-radius:999px; font-size:.8rem; color:#334155; background:#fff;
}

/* Texte court / remarques */
.kan-card__quick{ margin:.25rem 0 0; color:#374151; font-size:.95rem; }
.kan-card__notes{ color:#6b7280; font-size:.9rem; }
.one-line-ellipsis{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

/* Tags / assignees (chips réutilisables) */
.tag{
  display:inline-flex; align-items:center; gap:0.375rem;
  padding:0.25rem 0.625rem; border-radius:999px; font-size:.85rem; font-weight:700;
  background:#EEF2FF; border:1px solid var(--border); color:#1e293b;
}

/* ===== Boutons (compat) ===== */
.btn{
  padding:0.5rem 0.75rem; border-radius:0.625rem; background:#fff; cursor:pointer; border:1px solid var(--border);
  transition: box-shadow .12s ease, transform .12s ease, background .12s ease, border-color .12s ease;
}
.btn:hover{ box-shadow: var(--shadow-sm); transform: translateY(-1px); }
.btn.primary{ background:#7C3AED; color:#fff; border-color:#7C3AED; }
.btn.icon{ padding:0.375rem 0.5rem; }
.btn.danger { background:#fee2e2; border-color:#fecaca; color:#7a1c1c; }
.btn.danger:hover{ background:#fff1f2; }
.btn:not(.primary):hover{ background:#fff; }

/* ===== Mode réunion (thème clair mauve + disable visuel) ===== */
.agile.meeting-on .kan-col{ background:#f7f8fb; border-color:#e2e8f0; }
.agile.meeting-on .kan-col__title{ background:#eef2f7; }
.agile.meeting-on .kan-card{ background:#f9fafb; }
.agile.meeting-on .kan-card:hover{ transform:none; box-shadow: var(--shadow-sm); }

.agile.meeting-on .btn{ cursor:not-allowed; opacity:.6; box-shadow:none; }
.agile.meeting-on .kan-card[draggable="true"]{ cursor:grab; } /* pointer cohérent */

/* ======= Post-it / Notes de réunion ======= */
.notes-section{ margin-top: 1.25rem; }
.notes-title{ font-weight:800; margin: 0 0 .5rem .25rem; }

.notes-wrap{
  border:1px solid var(--border); border-radius:12px; background:#fff; padding:12px;
}
.notes-toolbar{
  display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:10px; flex-wrap:wrap;
}
.notes-grid{
  display:grid; grid-template-columns: repeat(2, minmax(220px, 1fr)); gap:12px;
}
@media (min-width: 980px){
  .notes-grid{ grid-template-columns: repeat(4, minmax(220px, 1fr)); }
}

.sticky{
  border-radius: 10px;
  padding: 10px;
  min-height: 160px;
  display:flex; flex-direction:column; gap:8px;
  box-shadow: 0 6px 18px rgba(0,0,0,.08);
  border: 1px solid rgba(0,0,0,.08);
}
.sticky.yellow{ background: #FEF9C3; }
.sticky.pink{   background: #FCE7F3; }
.sticky.green{  background: #D1FAE5; }
.sticky.blue{   background: #DBEAFE; }

.sticky-head{ display:flex; align-items:center; gap:8px; justify-content:space-between; }
.sticky textarea{
  width:100%; min-height: 90px; resize: vertical;
  background: transparent; border:1px dashed rgba(0,0,0,.15); border-radius: 8px; padding:8px;
  font: inherit; color:#111827; outline: none;
}
.sticky textarea:focus{ border-style: solid; box-shadow: 0 0 0 3px rgba(124,58,237,.12); }

.sticky .nt-inline.small{ font-size: .85rem; color:#374151; }
.sticky-tags{ margin-top:auto; }
.sticky .cell-input{
  width:100%;
  padding:0.35rem 0.5rem;
  border-radius:0.5rem; border:1px solid rgba(0,0,0,.12); background:#fff; font:inherit;
}

.nt-inline{ display:inline-flex; align-items:center; gap:6px; }
.nt-empty{ text-align:center; color:#6b7280; padding:16px; }
