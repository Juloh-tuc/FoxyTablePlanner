/* ===========================
   Planner Week — Fit Week (no horizontal scroll)
   Affiche TOUJOURS les 7 jours dans la largeur de l’écran.
   =========================== */

/* ---------- Variables ---------- */
:root {
  /* Dimensions fluides */
  --wrap-pad: clamp(12px, 3vw, 32px);
  --row-h: clamp(40px, 6.2vw, 72px);            /* hauteur de ligne adaptative */
  --sidebar-w: clamp(120px, 16vw, 220px);       /* colonne gauche proportionnelle */

  /* Rayons */
  --r-sm: 8px; --r: 12px; --r-lg: 16px;

  /* Couleurs (clair) */
  --bg: #f7f7fb;
  --card: #ffffff;
  --card-2: #fafafa;
  --border: #e5e7eb;
  --border-strong: #d1d5db;
  --text: #0b1220;
  --text-muted: #475569;
  --text-light: #64748b;

  /* Accent */
  --primary: #7c3aed;
  --primary-2: #8b5cf6;

  /* Statuts (soft) */
  --st-progress-bg: rgba(251,191,36,.12);
  --st-progress-br: rgba(251,191,36,.36);
  --st-progress-tx: #b45309;

  --st-done-bg: rgba(16,185,129,.12);
  --st-done-br: rgba(16,185,129,.36);
  --st-done-tx: #065f46;

  --st-blocked-bg: rgba(239,68,68,.12);
  --st-blocked-br: rgba(239,68,68,.36);
  --st-blocked-tx: #7f1d1d;

  --st-wait-bg: rgba(245,158,11,.12);
  --st-wait-br: rgba(245,158,11,.36);
  --st-wait-tx: #78350f;

  --st-info-bg: rgba(59,130,246,.12);
  --st-info-br: rgba(59,130,246,.36);
  --st-info-tx: #1e3a8a;

  /* Ombres & focus */
  --shadow-sm: 0 1px 2px rgba(0,0,0,.07);
  --shadow:    0 4px 12px rgba(0,0,0,.10);
  --shadow-lg: 0 12px 24px rgba(0,0,0,.12);
  --focus: 0 0 0 3px rgba(124,58,237,.18);
}

/* ---------- Dark ---------- */
:root[data-theme="dark"]{
  --bg:#0b1220; --card:#141b2d; --card-2:#0f172a;
  --border:#2c3549; --border-strong:#3a4763;
  --text:#e6edf7; --text-muted:#a5b4cf; --text-light:#8fa0be;

  --shadow-sm: 0 1px 2px rgba(0,0,0,.45);
  --shadow:    0 4px 12px rgba(0,0,0,.55);
  --shadow-lg: 0 12px 24px rgba(0,0,0,.6);
}

/* ---------- Page ---------- */
.week-cells{
  min-height:100vh; background: var(--bg); color: var(--text);
  font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, system-ui, sans-serif;
  line-height:1.5;
}

/* ---------- A11y ---------- */
.visually-hidden{
  position:absolute!important; width:1px!important; height:1px!important;
  padding:0!important; margin:-1px!important; overflow:hidden!important;
  clip:rect(0,0,0,0)!important; white-space:nowrap!important; border:0!important;
}

/* =========================================================
   LAYOUT CENTRÉ, MÊME LARGEUR POUR HEADER & TABLEAU
   Pas de largeur fixe : on s’adapte à la fenêtre.
   ========================================================= */

.week-controls{
  /* largeur égale au tableau */
  margin: 24px auto 0 auto;
  padding-inline: var(--wrap-pad);
  max-width: 100vw;
  display:flex; align-items:center; justify-content:space-between; gap:16px;

  background: var(--card);
  border: 1px solid var(--border-strong);
  border-bottom: none;
  border-radius: var(--r-lg) var(--r-lg) 0 0;
  box-shadow: var(--shadow);
  padding-block: clamp(10px, 1.4vw, 16px);
}
.week-title{
  font-size: clamp(1rem, 2.2vw, 1.3rem);
  font-weight: 900; letter-spacing:-.015em;
}

/* conteneur tableau */
.bleed-xl{
  margin: 0 auto 40px auto;
  padding-inline: var(--wrap-pad);
  max-width: 100vw;
}

/* ---------- Board ---------- */
.board{
  background: var(--card);
  border-radius: 0 0 var(--r-lg) var(--r-lg);
  border: 1px solid var(--border-strong);
  border-top: none; /* fusionne visuellement avec le header */
  box-shadow: var(--shadow-lg);
  overflow: hidden;           /* pas de scroll horizontal ici */
}

/* ---------- Grille (sidebar + 7 jours) ---------- */
/*
  Fit Week: pas de min-width. On “force” 7 colonnes visibles
  en laissant le navigateur répartir l’espace.
*/
.grid7{
  display:grid;
  grid-template-columns:
    minmax(100px, var(--sidebar-w))
    repeat(7, minmax(0, 1fr));        /* 7 jours visibles, sans scroll */
  width: 100%;
  background: var(--card);
}

/* ---------- Header ligne ---------- */
.head{
  background: var(--card-2);
  border-bottom:2px solid var(--border);
  position: sticky; top: 0; z-index:10;
}
.day-head{
  padding: clamp(10px, 1.4vw, 18px) 10px;
  text-align:center;
  border-left:1px solid var(--border);
  background: var(--card-2);
  transition: background .12s ease;
}
.day-head:first-child{ border-left:none; }

.day-head.spacer{
  text-align:left; display:flex; align-items:center;
  font-weight:800; font-size: clamp(.8rem, 1.6vw, .95rem);
  color: var(--text-muted); text-transform:uppercase; letter-spacing:.06em;
}
.day-head .dow{
  font-weight:800; font-size: clamp(.8rem, 1.7vw, .95rem); margin-bottom:2px;
}
.day-head .dom{
  font-weight:900; font-size: clamp(1rem, 2.3vw, 1.35rem); color: var(--text-muted);
}

/* Aujourd’hui très visible mais clean */
.day-head.is-today{
  background: color-mix(in srgb, var(--primary) 14%, var(--card-2));
  position:relative; color:#fff;
}
.day-head.is-today .dow, .day-head.is-today .dom{ color:#fff; }
.day-head.is-today::after{
  content:""; position:absolute; bottom:0; left:0; right:0;
  height:4px; background: linear-gradient(90deg, var(--primary), var(--primary-2));
}

/* ---------- Corps ---------- */
.body{
  position:relative;
  grid-auto-rows: var(--row-h);
  background: var(--card);
}
.col-left{
  background: var(--card);
  border-bottom:1px solid var(--border);
  display:flex; align-items:center; padding: 0 clamp(10px, 1.6vw, 18px);
  font-size: clamp(.82rem, 1.6vw, .95rem);
  color: var(--text-muted); font-weight:600;
}

/* ---------- Cellules ---------- */
.cell{
  border-left:1px solid var(--border);
  border-bottom:1px solid var(--border);
  display:flex; align-items:center; justify-content:center;
  background: var(--card);
  transition: background .1s ease, box-shadow .1s ease;
  cursor:pointer; position:relative;
}
.cell:hover{
  background: color-mix(in srgb, var(--primary) 6%, var(--card));
  box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--primary) 28%, var(--border));
}
.cell.pad{ background: var(--card); cursor:default; }

/* (Option) teinte week-end: ajouter .w-end côté TSX si souhaité */
.day-head.w-end, .cell.w-end{ background:#fbfbfe; }

/* ---------- Bouton “Ajouter” ---------- */
.add-btn{
  font-size: clamp(.8rem, 1.6vw, .95rem);
  font-weight:700;
  padding: clamp(6px, 1vw, 10px) clamp(10px, 1.6vw, 18px);
  border-radius: var(--r);
  border:2px dashed var(--border);
  background:#fff; color: var(--text-muted);
  display:flex; align-items:center; gap:8px;
  transition: all .12s ease;
}
.add-btn::before{ content:"+"; font-weight:800; font-size:1.1em; }
.add-btn:hover{
  border-color: var(--primary);
  color: var(--primary);
  background: color-mix(in srgb, var(--primary) 8%, #fff);
  transform: translateY(-1px);
  box-shadow: var(--shadow-sm);
}
.add-btn:focus-visible{ outline:none; box-shadow: var(--focus); }

/* ---------- Barres de tâches ---------- */
.task-bar{
  z-index:5; align-self:center;
  height: clamp(34px, 4.5vw, 48px);
  margin: clamp(3px, .6vw, 6px);
  border-radius: var(--r);
  border:1px solid var(--border);
  background: var(--card);
  box-shadow: var(--shadow);
  display:flex; align-items:center; gap: clamp(6px, 1vw, 12px);
  padding: clamp(6px, 1vw, 10px) clamp(10px, 1.6vw, 16px);
  cursor:pointer; transition: all .12s ease; overflow:hidden; position:relative;
}
.task-bar::before{
  content:""; position:absolute; left:0; top:0; bottom:0;
  width: clamp(3px, .6vw, 5px);
  background: var(--status-color, var(--border));
}
.task-bar:hover{ transform: translateY(-2px); box-shadow: var(--shadow-lg); }
.task-bar:focus-visible{ outline:none; box-shadow: var(--focus); }

.bar-title{
  font-weight:800; font-size: clamp(.82rem, 1.8vw, 1rem); color: var(--text);
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  flex:1; min-width:0;
}
.bar-meta{ display:flex; gap: clamp(6px, 1vw, 8px); align-items:center; flex-shrink:0; }

/* Statuts */
.task-bar.is-progress{ --status-color: var(--st-progress-tx); background: var(--st-progress-bg); border-color: var(--st-progress-br); }
.task-bar.is-done{     --status-color: var(--st-done-tx);     background: var(--st-done-bg);     border-color: var(--st-done-br); }
.task-bar.is-blocked{  --status-color: var(--st-blocked-tx);  background: var(--st-blocked-bg);  border-color: var(--st-blocked-br); }
.task-bar.is-wait{     --status-color: var(--st-wait-tx);     background: var(--st-wait-bg);     border-color: var(--st-wait-br); }
.task-bar.is-info{     --status-color: var(--st-info-tx);     background: var(--st-info-bg);     border-color: var(--st-info-br); }

/* Badges / chips */
.badge-prio{
  display:inline-flex; align-items:center; gap:6px;
  padding:2px 8px; border-radius:999px; font-size: clamp(.7rem, 1.4vw, .8rem);
  font-weight:800; background: rgba(107,114,128,.08);
  color: var(--text-muted); border:1px solid rgba(107,114,128,.18);
}
.badge-prio[data-level="Faible"]{ background: rgba(34,197,94,.12); color:#15803d; border-color: rgba(34,197,94,.28); }
.badge-prio[data-level="Élevé"]{  background: rgba(239,68,68,.12); color:#b91c1c; border-color: rgba(239,68,68,.28); }
.badge-prio .dot{ width:6px; height:6px; border-radius:999px; background: currentColor; }

.status-chip{
  display:inline-flex; align-items:center; gap:6px;
  padding:3px 8px; border-radius:999px; font-size: clamp(.7rem, 1.4vw, .8rem);
  font-weight:800; opacity:.95;
}
.status-chip .dot{ width:6px; height:6px; border-radius:999px; background: currentColor; }
.status-chip.is-progress{ color: var(--st-progress-tx); }
.status-chip.is-done{     color: var(--st-done-tx); }
.status-chip.is-blocked{  color: var(--st-blocked-tx); }
.status-chip.is-wait{     color: var(--st-wait-tx); }
.status-chip.is-info{     color: var(--st-info-tx); }

/* Ligne “Aujourd’hui” visible mais fine si l’écran est étroit */
.today-line{
  z-index:6;
  width: clamp(2px, .6vw, 6px); border-radius:3px;
  background: linear-gradient(180deg, var(--primary) 0%, var(--primary-2) 100%);
  box-shadow: 0 0 10px color-mix(in srgb, var(--primary) 60%, transparent);
}

/* ---------- Modale ---------- */
.modal-backdrop{
  position:fixed; inset:0; background: rgba(0,0,0,.45); backdrop-filter: blur(4px);
  display:flex; align-items:center; justify-content:center; z-index:50; padding:16px;
}
.modal{
  width:min(680px, 100%); max-height:90vh; overflow:auto;
  background: var(--card); border-radius: var(--r-lg);
  border:1px solid var(--border); box-shadow: var(--shadow-lg); padding:24px;
}
.modal h2{ margin:0 0 18px; font-size:1.2rem; font-weight:900; }
.form{
  display:grid; gap:16px; grid-template-columns: repeat(auto-fit, minmax(240px,1fr));
  margin-bottom:22px;
}
.form label{ display:flex; flex-direction:column; gap:6px; font-weight:800; font-size:.95rem; }
.form input, .form select{
  padding:12px 14px; border:1.5px solid var(--border); border-radius: var(--r);
  background: var(--card-2); color: var(--text);
  transition: border .12s ease, box-shadow .12s ease, background .12s ease;
}
.form input:focus, .form select:focus{ outline:none; border-color: var(--primary); box-shadow: var(--focus); background:#fff; }
.form input::placeholder{ color: var(--text-light); }
.modal-actions{ display:flex; align-items:center; gap:12px; padding-top:18px; border-top:1px solid var(--border); }

/* ---------- Boutons ---------- */
.btn{
  display:inline-flex; align-items:center; justify-content:center; gap:6px;
  padding:10px 18px; border:1px solid var(--border); border-radius: var(--r);
  background: var(--card); color: var(--text); font-weight:800; font-size:.9rem;
  cursor:pointer; transition: all .12s ease; white-space:nowrap;
}
.btn:hover{ background: var(--card-2); transform: translateY(-1px); box-shadow: var(--shadow-sm); }
.btn:focus-visible{ outline:none; box-shadow: var(--focus); }
.btn.primary{ background: var(--primary); color:#fff; border-color: var(--primary); }
.btn.primary:hover{ background: var(--primary-2); border-color: var(--primary-2); }
.btn.danger{ background: rgba(239,68,68,.12); color:#991b1b; border-color: rgba(239,68,68,.36); }
.btn.danger:hover{ background: rgba(239,68,68,.18); border-color: rgba(239,68,68,.42); }

/* ---------- Responsif (garde toujours 7 colonnes visibles) ---------- */
@media (max-width: 1024px){
  :root{
    --sidebar-w: clamp(100px, 18vw, 180px);
    --row-h: clamp(38px, 7vw, 64px);
  }
  .bar-meta{ display:none; }           /* épure quand l’espace se resserre */
}
@media (max-width: 720px){
  :root{
    --sidebar-w: clamp(90px, 20vw, 150px);
    --row-h: clamp(34px, 8vw, 56px);
  }
  .day-head .dow{ display:none; }      /* garde la date, retire le label jour */
  .week-title{ font-size: clamp(.95rem, 4vw, 1.1rem); }
}

/* ---------- Impression ---------- */
@media print{
  .modal-backdrop, .add-btn, .week-controls{ display:none!important; }
  .board{ box-shadow:none; border:1px solid #999; border-radius: var(--r); }
  .task-bar{ box-shadow:none; border:1px solid #777; background:#fff!important; }
  .today-line{ display:none; }
}
